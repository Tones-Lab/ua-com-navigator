###############################################################################
# netTest-NNA-QF-NO-ALARM-MIB
# Automatically created by mib2rules (http://www.ibm.com/software/tivoli/gat)
# Thu Jun 30 15:11:10 2011
###############################################################################

our ($Log, $Event, $node, $ip, $agent, $generic, $specific, $enterprise, @value);

my ( $nnaQfNoAlarmDateAndTime, $nnaQfNoAlarmDescription, $nnaQfNoAlarmDomainId,
$nnaQfNoAlarmDomainUserLabel, $nnaQfNoAlarmElementId, $nnaQfNoAlarmEventType,
$nnaQfNoAlarmLatitude, $nnaQfNoAlarmLongitude, $nnaQfNoAlarmOpticalDistance,
$nnaQfNoAlarmPerceivedSeverity, $nnaQfNoAlarmPhysicalDistance, $nnaQfNoAlarmProbableCause,
$nnaQfNoAlarmUserLabel, );

my ( $DEFAULT_ExpireTime, $DEFAULT_Type, $OS_EventId, );
my $dateval;

$Event->{Agent} = "NNA-QF-NO-ALARM-MIB";
$Event->{Class} = "300";
$Event->{Node} = $ip;

if (0) { # Dummy

} elsif ($specific == "1") { ### - nnaQfNoBaseAlarmCleared
    #######################
    #
    # This notification is emitted when a more specific  
    # notification type is not available and a QUESTFiber 
    # alarm condition is cleared.   
    # 
    # A base alarm cleared condition is modeled as a 
    # change to a value of 'cleared(1)' of the perceived 
    # severity associated with this alarm condition. 
    # 
    # All information about this base alarm cleared 
    # condition is contained within the object list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoBaseAlarmCleared";

    $Event->{AlarmGroup} = "nnaQfNoBaseAlarmCleared";
    $Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType;

    #$DEFAULT_Severity = 1;
    $DEFAULT_Type = 0;
    $DEFAULT_ExpireTime = 0;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity;
    $Event->{Location} = $nnaQfNoAlarmDescription;
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;

} elsif ($specific == "2") { ### - nnaQfNoBaseAlarmSet
    #######################
    #
    # This notification is emitted when a more specific  
    # notification type is not available and a QUESTFiber 
    # alarm condition is set.   
    # 
    # A base alarm set condition is modeled as a change 
    # to one of the following values for the perceived 
    # severity associated with this alarm condition: 
    # 
    # indeterminate(2), 
    # critical(3), 
    # major(4), 
    # minor(5), 
    # warning(6) 
    # 
    # All information about this alarm set condition is 
    # contained within the object list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoBaseAlarmSet";

    $Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType;

    $DEFAULT_Type = 0;
    $DEFAULT_ExpireTime = 0;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity;
    $Event->{AlarmGroup} = $nnaQfNoAlarmEventType;
    $Event->{AlarmType} = 2;
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;

} elsif ($specific == "3") { ### - nnaQfNoCircuitAlarmCleared
    #######################
    #
    # This notification is emitted when a QUESTFiber 
    # circuit alarm condition is cleared.   
    # 
    # A circuit alarm cleared condition is modeled as a 
    # change to a value of 'cleared(1)' of the perceived 
    # severity associated with this alarm condition. 
    # 
    # All information about this circuit alarm cleared 
    # condition is contained within the object list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    # $value[9] = nnaQfNoAlarmUserLabel
    #
    #      An administratively assigned label identifying the 
    #      circuit or communication equipment associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[10] = nnaQfNoAlarmOpticalDistance
    #
    #      The optical distance, in centimeters, to the 
    #      nearest landmark or cable marker, before the event 
    #      locus associated with this alarm condition .
    #
    # $value[11] = nnaQfNoAlarmPhysicalDistance
    #
    #      The physical distance, in centimeters, to the 
    #      nearest landmark or cable marker, before the event 
    #      locus associated with this alarm condition .
    #
    # $value[12] = nnaQfNoAlarmLatitude
    #
    #      The latitude of the event locus associated with 
    #      this alarm condition. 
    #      
    #      The value of this object is a displayable string 
    #      representing a real number.  Values exist within a 
    #      range of -180..180 degrees. Positive numbers 
    #      indicate locations east of the prime meridian. 
    #      
    #      The zero-length string indicates that the latitude 
    #      for the event locus is not configured at, or, is 
    #      not known to, the QUESTFiber server. 
    #      
    #      [ED:  provide some examples]
    #
    # $value[13] = nnaQfNoAlarmLongitude
    #
    #      The longitude of the event locus associated with 
    #      this alarm condition . 
    #      
    #      The value of this object is a displayable string 
    #      representing a real number.  Values exist within a 
    #      range of -90..90 degrees. Positive numbers indicate 
    #      locations north of the equator. 
    #      
    #      The zero-length string indicates that the longitude 
    #      for the event locus is not configured at, or, is 
    #      not known to, the QUESTFiber server. 
    #      
    #      [ED:  provide some examples]
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');
    $nnaQfNoAlarmUserLabel = $value[9];
    $nnaQfNoAlarmOpticalDistance = $value[10];
    $nnaQfNoAlarmPhysicalDistance = $value[11];
    $nnaQfNoAlarmLatitude = $value[12];
    $nnaQfNoAlarmLongitude = $value[13];

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoCircuitAlarmCleared";

    #$Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType.$nnaQfNoAlarmUserLabel.$nnaQfNoAlarmOpticalDistance.$nnaQfNoAlarmPhysicalDistance.$nnaQfNoAlarmLatitude.$nnaQfNoAlarmLongitude

    $DEFAULT_Type = 0;
    $DEFAULT_ExpireTime = 0;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity;
    $Event->{AlarmGroup} = $nnaQfNoAlarmEventType;
    $Event->{AlarmType} = 1;
    $Event->{SubAlarmGroup} = $Event->{AlarmGroup} ."". $Event->{Summary};
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;
    #########Eirteic FDA: hex time to epoch seconds#######
    $dateval = datetotime( $nnaQfNoAlarmDateAndTime, 'DateAndTime');
    $Event->{LastReported} = $dateval;
    #### Fin Reglas de Conversion  #####

} elsif ($specific == "4") { ### - nnaQfNoCircuitAlarmSet
    #######################
    #
    # This notification is emitted when a QUESTFiber 
    # circuit alarm condition is set.   
    # 
    # A circuit alarm set condition is modeled as a 
    # change to one of the following values of the 
    # perceived severity associated with this alarm 
    # condition: 
    # 
    # indeterminate(2), 
    # critical(3), 
    # major(4), 
    # minor(5), 
    # warning(6) 
    # 
    # All information about this circuit alarm set 
    # condition is contained within the object list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    # $value[9] = nnaQfNoAlarmUserLabel
    #
    #      An administratively assigned label identifying the 
    #      circuit or communication equipment associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[10] = nnaQfNoAlarmOpticalDistance
    #
    #      The optical distance, in centimeters, to the 
    #      nearest landmark or cable marker, before the event 
    #      locus associated with this alarm condition .
    #
    # $value[11] = nnaQfNoAlarmPhysicalDistance
    #
    #      The physical distance, in centimeters, to the 
    #      nearest landmark or cable marker, before the event 
    #      locus associated with this alarm condition .
    #
    # $value[12] = nnaQfNoAlarmLatitude
    #
    #      The latitude of the event locus associated with 
    #      this alarm condition. 
    #      
    #      The value of this object is a displayable string 
    #      representing a real number.  Values exist within a 
    #      range of -180..180 degrees. Positive numbers 
    #      indicate locations east of the prime meridian. 
    #      
    #      The zero-length string indicates that the latitude 
    #      for the event locus is not configured at, or, is 
    #      not known to, the QUESTFiber server. 
    #      
    #      [ED:  provide some examples]
    #
    # $value[13] = nnaQfNoAlarmLongitude
    #
    #      The longitude of the event locus associated with 
    #      this alarm condition . 
    #      
    #      The value of this object is a displayable string 
    #      representing a real number.  Values exist within a 
    #      range of -90..90 degrees. Positive numbers indicate 
    #      locations north of the equator. 
    #      
    #      The zero-length string indicates that the longitude 
    #      for the event locus is not configured at, or, is 
    #      not known to, the QUESTFiber server. 
    #      
    #      [ED:  provide some examples]
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');
    $nnaQfNoAlarmUserLabel = $value[9];
    $nnaQfNoAlarmOpticalDistance = $value[10];
    $nnaQfNoAlarmPhysicalDistance = $value[11];
    $nnaQfNoAlarmLatitude = $value[12];
    $nnaQfNoAlarmLongitude = $value[13];

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoCircuitAlarmSet";

    #$Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType.$nnaQfNoAlarmUserLabel.$nnaQfNoAlarmOpticalDistance.$nnaQfNoAlarmPhysicalDistance.$nnaQfNoAlarmLatitude.$nnaQfNoAlarmLongitude

    $DEFAULT_Type = 0;
    $DEFAULT_ExpireTime = 0;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity;
    $Event->{AlarmGroup} = $nnaQfNoAlarmEventType;
    $Event->{AlarmType} = 2;
    $Event->{SubAlarmGroup} = $Event->{AlarmGroup} ."". $Event->{Summary};
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;
    #########Eirteic FDA: hex time to epoch seconds#######
    $dateval = datetotime( $nnaQfNoAlarmDateAndTime, 'DateAndTime');
    $Event->{LastReported} = $dateval;
    #### Fin Reglas de Conversion  #####

} elsif ($specific == "5") { ### - nnaQfNoEquipmentAlarmCleared
    #######################
    #
    # This notification is emitted when a QUESTFiber 
    # equipment alarm condition is cleared.   
    # 
    # A equipment alarm cleared condition is modeled as a 
    # change to a value of 'cleared(1)' of the perceived 
    # severity associated with this alarm condition. 
    # 
    # All information about this equipment alarm cleared 
    # condition is contained within the object list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    # $value[9] = nnaQfNoAlarmUserLabel
    #
    #      An administratively assigned label identifying the 
    #      circuit or communication equipment associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');
    $nnaQfNoAlarmUserLabel = $value[9];

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoEquipmentAlarmCleared";

    $Event->{AlarmGroup} = "nnaQfNoEquipmentAlarmCleared";
    $Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType.$nnaQfNoAlarmUserLabel;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity	;
    $DEFAULT_Type = 0;
    $DEFAULT_ExpireTime = 0;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;

} elsif ($specific == "6") { ### - nnaQfNoEquipmentAlarmSet
    #######################
    #
    # This notification is emitted when a QUESTFiber 
    # equipment alarm condition is set.   
    # 
    # A equipment alarm set condition is modeled as a 
    # change to one of the following values of the 
    # perceived severity associated with this alarm 
    # condition: 
    # 
    # indeterminate(2), 
    # critical(3), 
    # major(4), 
    # minor(5), 
    # warning(6) 
    # 
    # All information about this equipment alarm set 
    # condition is contained within the object list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    # $value[9] = nnaQfNoAlarmUserLabel
    #
    #      An administratively assigned label identifying the 
    #      circuit or communication equipment associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');
    $nnaQfNoAlarmUserLabel = $value[9];

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoEquipmentAlarmSet";

    $Event->{AlarmGroup} = "nnaQfNoEquipmentAlarmSet";
    $Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType.$nnaQfNoAlarmUserLabel;

    $DEFAULT_Type = 0;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $DEFAULT_ExpireTime = 0;
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;

} elsif ($specific == "7") { ### - nnaQfNoEquipCommAlarmCleared
    #######################
    #
    # This notification is emitted when a QUESTFiber 
    # equipment communication alarm condition is cleared.   
    # 
    # An equipment communication alarm cleared condition 
    # is modeled as a change to a value of 'cleared(1)' 
    # of the perceived severity associated with this 
    # alarm condition. 
    # 
    # All information about this equipment communication 
    # alarm cleared condition is contained within the 
    # object list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    # $value[9] = nnaQfNoAlarmUserLabel
    #
    #      An administratively assigned label identifying the 
    #      circuit or communication equipment associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');
    $nnaQfNoAlarmUserLabel = $value[9];

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoEquipCommAlarmCleared";

    $Event->{AlarmGroup} = "nnaQfNoEquipCommAlarmCleared";
    $Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType.$nnaQfNoAlarmUserLabel;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $DEFAULT_Type = 0;
    $DEFAULT_ExpireTime = 0;
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;

} elsif ($specific == "8") { ### - nnaQfNoEquipCommAlarmSet
    #######################
    #
    # This notification is emitted when a QUESTFiber 
    # equipment communication alarm condition is set.   
    # 
    # A equipment communication alarm set condition is 
    # modeled as a change to one of the following values 
    # of the perceived severity associated with this 
    # alarm condition: 
    # 
    # indeterminate(2), 
    # critical(3), 
    # major(4), 
    # minor(5), 
    # warning(6) 
    # 
    # All information about this equipment communication 
    # alarm set condition is contained within the object 
    # list.
    #
    # $value[1] = nnaQfNoAlarmPerceivedSeverity
    #
    #      The perceived severity of this alarm condition .
    #
    # $value[2] = nnaQfNoAlarmDateAndTime
    #
    #      The local date and time when this alarm condition  
    #      was logged by the QUESTFiber server. 
    #      
    #      Offset from UTC is included when available.
    #
    # $value[3] = nnaQfNoAlarmElementId
    #
    #      Unique identifier of the element associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[4] = nnaQfNoAlarmDomainId
    #
    #      An SNMP tag list of domains to which the indicated 
    #      element belongs.  
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the 
    #      nnaQfNoAlarmDomainUserLabel object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[5] = nnaQfNoAlarmDomainUserLabel
    #
    #      An SNMP tag list of administratively assigned 
    #      domain labels for the associated tag list of 
    #      domains (see nnaQfNoAlarmDomainId). 
    #      
    #      The number of tag values for an instance of this 
    #      object MUST match the number of tag values for the 
    #      associated instance of the nnaQfNoAlarmDomainId 
    #      object. 
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    # $value[6] = nnaQfNoAlarmDescription
    #
    #      A description of the problem for this alarm 
    #      condition. 
    #      
    #      Example values are as follows: 
    #      
    #      'Alarm input from external device, channel 
    #      <Integer>' 
    #      
    #      'Gain Tilt or Slope deviations exceeded' 
    #      
    #      'Deviations exceeded on channel(s): <Integer> 
    #      <Integer>...' 
    #      
    #      'Trace Compare Deviation greater than <Double> 
    #      db' 
    #      
    #      'Launch Level Deviation greater than <Double> 
    #      db' 
    #      
    #      'End Detect Deviation greater than <Double> 
    #      db' 
    #      
    #      'Communication Loss between TSC and RTU: 
    #      <Probe User Label>' 
    #      
    #      'Net Communications Lost with the RTU.' 
    #      
    #      'Unable to Establish serial communications 
    #      with the RTU.' 
    #      
    #      'Alarm Present On Serial RTU.' 
    #      
    #      'Mulitple Alarms Present on Serial RTU.' 
    #      
    #      'Unknown Communication Problem with RTU.' 
    #      
    #      'RTU Self test error.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'RTU Has No database.' 
    #      
    #      'RTU Software failure.' 
    #      
    #      'Control Unit alarm.' 
    #      
    #      'Self Test alarm.' 
    #      
    #      'OTAU Fault.' 
    #      
    #      'ProbableCause Unknow.' 
    #      
    #      
    #      
    #      'Trace compare deviation.' 
    #      
    #      'External Alarm Closure Detected.' 
    #      
    #      'End Detect Alarm.' 
    #      
    #      'Launch Level Deviation Exceeded.' 
    #      
    #      'Invalid switch Position in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Range/Resolution PulseWidth Setup in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Invalid Index Of Refraction in StarProbe 
    #      Fiber Circuit.' 
    #      
    #      'Invalid Wavelength in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'Invalid Averages Setting in StarProbe Fiber 
    #      Circuit.' 
    #      
    #      'StarProbe Fiber Circuit RTU ID not equal to 
    #      RTU ID' 
    #      
    #      'Invalid Loss Values for Surveillance in 
    #      StarProbe Fiber Circuit.' 
    #      
    #      'Unknown Specific Problem.' 
    #      
    #      'Probe <Probe User Label> is out of synch with 
    #      Server Please resynchronize and contact 
    #      Nettest customer support'
    #
    # $value[7] = nnaQfNoAlarmProbableCause
    #
    #      The probable cause associated with this alarm 
    #      condition . 
    #      
    #      [ED:  list each of the enumerated values in the 
    #      IANAItuProbableCause TC that the QUESTFiber server 
    #      will emit, at time of publication.]
    #
    # $value[8] = nnaQfNoAlarmEventType
    #
    #      The ITU event type associated with this alarm 
    #      condition . 
    #      
    #      The following ITU types correlate with the 
    #      following QUESTFiber event types: 
    #      
    #      other(1)                 - circuit alarm 
    #      communicationsAlarm(2)   - equipment 
    #      communication 
    #      alarm 
    #      equipmentAlarm(5)        - equipment alarm 
    #      
    #      As other ITU event types are used, this module will 
    #      be revised to reflect their usage.
    #
    # $value[9] = nnaQfNoAlarmUserLabel
    #
    #      An administratively assigned label identifying the 
    #      circuit or communication equipment associated with 
    #      this alarm condition .   
    #      
    #      Example values follow: 
    #      [ED: add some example values]
    #
    #######################
    $nnaQfNoAlarmPerceivedSeverity = lookup($value[1],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmPerceivedSeverity');
    $nnaQfNoAlarmDateAndTime = $value[2];
    $nnaQfNoAlarmElementId = $value[3];
    $nnaQfNoAlarmDomainId = $value[4];
    $nnaQfNoAlarmDomainUserLabel = $value[5];
    $nnaQfNoAlarmDescription = $value[6];
    $nnaQfNoAlarmProbableCause = lookup($value[7],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmProbableCause');
    $nnaQfNoAlarmEventType = lookup($value[8],'netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoAlarmEventType');
    $nnaQfNoAlarmUserLabel = $value[9];

    $OS_EventId = "SNMPTRAP-netTest-NNA-QF-NO-ALARM-MIB-nnaQfNoEquipCommAlarmSet";

    $Event->{AlarmGroup} = "nnaQfNoEquipCommAlarmSet";
    $Event->{SubAlarmGroup} = $nnaQfNoAlarmPerceivedSeverity.$nnaQfNoAlarmDateAndTime.$nnaQfNoAlarmElementId.$nnaQfNoAlarmDomainId.$nnaQfNoAlarmDomainUserLabel.$nnaQfNoAlarmDescription.$nnaQfNoAlarmProbableCause.$nnaQfNoAlarmEventType.$nnaQfNoAlarmUserLabel;

    $DEFAULT_Type = 0;
    $Event->{Severity} = $nnaQfNoAlarmPerceivedSeverity;
    $Event->{Summary} = $nnaQfNoAlarmProbableCause;
    $DEFAULT_ExpireTime = 0;
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{SubAlarmGroup} . " " . $Event->{AlarmGroup} . " " . $DEFAULT_Type . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $specific;

} else {
    $Event->{Summary} = "Unknown Specific Trap Number (" . $specific . ") Received for Enterprise " . $enterprise;
    $Event->{Severity} = 1;
    $Event->{AlarmKey} = $Event->{Node} . " " . $Event->{Agent} . " " . $Event->{SubMethod} . " " . $enterprise . " " . $generic . " " . $specific;
}

# netcool rules file has "@Identifier = @LastOccurrence" here.
# Seems strange to me, but there you go...
$Event->{AlarmKey} = $Event->{LastReported};
$Event->{Fiber_Circuit} = $value[9];

Log->Message('DEBUG', "<<<<< Leaving... netTest-NNA-QF-NO-ALARM-MIB.include.snmptrap.rules >>>>>");
